# Alink使用之pyalink的基本操作

**1 基本操作**

--1.1 读取csv文件
- 基于panda是
~~~
import pandas as pd
#读取数据
data = pd.read_csv('/Users/leowu/iie/11/dataset/data.csv',header=None) 
~~~

- 基于 Operator (训练、测试数据集的划分)
~~~
URL = "/Users/leowu/iie/11/dataset/data.csv"
SCHEMA_STR = "f0 double, f1 double, f2 double, f3 double, label double";
data = CsvSourceBatchOp().setFilePath(URL).setSchemaStr(SCHEMA_STR)
spliter = SplitBatchOp().setFraction(0.8)
train_data = spliter.linkFrom(data)
test_data = spliter.getSideOutput(0)
~~~

--1.2 聚类kmeans模型的训练、预测、评估(带标签)
- 训练、预测
~~~
FEATURE_COLS = ["f0", "f1", "f2", "f3"]
VECTOR_COL = "vec"
PRED_COL = "pred"
vectorAssembler = (
    VectorAssembler()
    .setSelectedCols(FEATURE_COLS)
    .setOutputCol(VECTOR_COL)
)
kMeans = (
    KMeans()
    .setVectorCol(VECTOR_COL)
    .setK(2)
    .setPredictionCol(PRED_COL)
)
pipeline = Pipeline().add(vectorAssembler).add(kMeans)
model = pipeline.fit(train_data)
res = model.transform(test_data)
~~~

- 评估(由于pyalink没有提供kmeans模型外部性能评估实现，所以采用sklearn提供的接口)
~~~
from sklearn.metrics.cluster import adjusted_rand_score
#adjusted_rand_score(test_d, res.iloc[:, 6])
adjusted_rand_score([0.0, 0.0, 1.0, 1.0], [0, 0, 1, 1])
~~~


**参考**

- [Operator 与 Dataframe 互操作](https://github.com/alibaba/Alink/blob/master/docs/pyalink/pyalink-dataframe.md)
- [机器学习中常用的评估指标](https://juejin.im/post/5da2e88851882555a843023d#heading-32)
- [sklearn文档](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.adjusted_rand_score.html)


